var ve=Object.defineProperty;var Ne=(t,s,i)=>s in t?ve(t,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[s]=i;var H=(t,s,i)=>(Ne(t,typeof s!="symbol"?s+"":s,i),i);import{r as d,b as Se,a as le}from"./vendor-92c95717.js";import{L as U,u as ke,a as Oe,b as Te,R as Ee,c as A,N as Ce,B as Pe}from"./router-adb422dd.js";import{m as c,A as X}from"./motion-6ca97e44.js";import{B as J,U as Be,C as Ae,H as ce,P as de,A as Ie,R as Le,a as ue,b as me,S as ee,F as Re,c as he,V as De,d as Ue,e as Fe,f as Me,g as _e}from"./icons-1d13e935.js";import{Q as Je,a as ze}from"./query-3801a2c7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const g of n.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&r(g)}).observe(document,{childList:!0,subtree:!0});function i(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(a){if(a.ep)return;a.ep=!0;const n=i(a);fetch(a.href,n)}})();var xe={exports:{}},z={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var He=d,Xe=Symbol.for("react.element"),Qe=Symbol.for("react.fragment"),$e=Object.prototype.hasOwnProperty,Ge=He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ve={key:!0,ref:!0,__self:!0,__source:!0};function fe(t,s,i){var r,a={},n=null,g=null;i!==void 0&&(n=""+i),s.key!==void 0&&(n=""+s.key),s.ref!==void 0&&(g=s.ref);for(r in s)$e.call(s,r)&&!Ve.hasOwnProperty(r)&&(a[r]=s[r]);if(t&&t.defaultProps)for(r in s=t.defaultProps,s)a[r]===void 0&&(a[r]=s[r]);return{$$typeof:Xe,type:t,key:n,ref:g,props:a,_owner:Ge.current}}z.Fragment=Qe;z.jsx=fe;z.jsxs=fe;xe.exports=z;var e=xe.exports,Q={},te=Se;Q.createRoot=te.createRoot,Q.hydrateRoot=te.hydrateRoot;const se={theme:"system",autoSave:!0,autoSaveInterval:3e4,defaultPageLayout:"single-photo",showTutorial:!0,enableSounds:!0,enableAnimations:!0,preferredLanguage:"en",privacySettings:{allowAnalytics:!1,allowCrashReporting:!0}},pe=d.createContext(void 0),Ye=({value:t,children:s})=>e.jsx(pe.Provider,{value:t,children:s}),G=()=>{const t=d.useContext(pe);if(t===void 0)throw new Error("useApp must be used within an AppProvider");return t},qe=d.createContext(void 0),Ze=({children:t})=>{const{settings:s,setSettings:i}=G(),[r,a]=d.useState("light");d.useEffect(()=>{const w=()=>{if(s.theme==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)").matches;a(u?"dark":"light")}else a(s.theme)};if(w(),s.theme==="system"){const u=window.matchMedia("(prefers-color-scheme: dark)");return u.addEventListener("change",w),()=>u.removeEventListener("change",w)}},[s.theme]),d.useEffect(()=>{document.documentElement.classList.toggle("dark",r==="dark")},[r]);const n=w=>{const u={...s,theme:w};i(u),localStorage.setItem("baby-book-settings",JSON.stringify(u))},g=()=>{s.theme==="light"?n("dark"):s.theme==="dark"?n("system"):n("light")},f={theme:s.theme,effectiveTheme:r,setTheme:n,toggleTheme:g};return e.jsx(qe.Provider,{value:f,children:t})},We=d.createContext(void 0),Ke=({children:t})=>{const[s,i]=d.useState([]),r=d.useCallback(f=>{const w={...f,id:crypto.randomUUID(),timestamp:new Date};i(o=>[...o,w]);const u=f.duration??5e3;u>0&&setTimeout(()=>{i(o=>o.filter(l=>l.id!==w.id))},u)},[]),a=d.useCallback(f=>{i(w=>w.filter(u=>u.id!==f))},[]),n=d.useCallback(()=>{i([])},[]),g={notifications:s,addNotification:r,removeNotification:a,clearNotifications:n};return e.jsx(We.Provider,{value:g,children:t})},et=({children:t,className:s=""})=>e.jsx("div",{className:`min-h-screen flex flex-col ${s}`,children:e.jsx(c.main,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex-1",children:t})}),tt=({book:t,index:s=0})=>{const i=r=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(new Date(r));return e.jsx(c.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,delay:s*.1,ease:[.25,.46,.45,.94]},whileHover:{y:-8,scale:1.02,transition:{duration:.2}},whileTap:{scale:.98},className:"group cursor-pointer",children:e.jsxs(U,{to:`/book/${t.id}`,className:"block bg-white rounded-xl shadow-sm hover:shadow-lg transition-all duration-200 overflow-hidden border border-neutral-100 hover:border-primary-200","aria-label":`View ${t.title} - Created ${i(t.dateCreated)}`,children:[e.jsxs("div",{className:"relative aspect-[4/3] bg-gradient-to-br from-primary-50 to-secondary-50 overflow-hidden",children:[t.coverImage?e.jsx("img",{src:t.coverImage.url,alt:t.coverImage.altText||`Cover of ${t.title}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-primary-100 to-secondary-100",children:e.jsx(J,{className:"w-16 h-16 text-primary-400 group-hover:text-primary-500 transition-colors","aria-hidden":"true"})}),e.jsxs("div",{className:"absolute top-3 right-3 bg-white/90 backdrop-blur-sm rounded-full px-2 py-1 text-xs font-medium text-neutral-700 shadow-sm",children:[t.totalPages," ",t.totalPages===1?"page":"pages"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-800 mb-1 line-clamp-1 group-hover:text-primary-600 transition-colors",children:t.title}),e.jsx("p",{className:"text-sm text-neutral-600 line-clamp-2 leading-relaxed",children:t.description||"A collection of precious memories and moments."})]}),e.jsxs("div",{className:"space-y-2",children:[t.metadata.babyName&&e.jsxs("div",{className:"flex items-center text-xs text-neutral-500",children:[e.jsx(Be,{className:"w-3 h-3 mr-1.5 flex-shrink-0","aria-hidden":"true"}),e.jsx("span",{className:"truncate",children:t.metadata.babyName})]}),e.jsxs("div",{className:"flex items-center text-xs text-neutral-500",children:[e.jsx(Ae,{className:"w-3 h-3 mr-1.5 flex-shrink-0","aria-hidden":"true"}),e.jsxs("span",{children:["Created ",i(t.dateCreated)]})]})]})]}),e.jsx("div",{className:"absolute inset-0 bg-primary-500/0 group-hover:bg-primary-500/5 transition-colors duration-200 pointer-events-none"})]})})},st=({index:t=0})=>e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:t*.05},className:"bg-white rounded-xl shadow-sm border border-neutral-100 overflow-hidden",children:[e.jsxs("div",{className:"relative aspect-[4/3] bg-gradient-to-br from-neutral-100 to-neutral-150 animate-pulse",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -skew-x-12 animate-shimmer"}),e.jsx("div",{className:"absolute top-3 right-3 bg-neutral-200 rounded-full px-2 py-1 animate-pulse",children:e.jsx("div",{className:"h-3 w-12 bg-neutral-300 rounded"})})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-5 bg-neutral-200 rounded animate-pulse"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 bg-neutral-150 rounded w-full animate-pulse"}),e.jsx("div",{className:"h-4 bg-neutral-150 rounded w-3/4 animate-pulse"})]})]}),e.jsxs("div",{className:"space-y-2 pt-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 bg-neutral-200 rounded-full mr-1.5 animate-pulse"}),e.jsx("div",{className:"h-3 bg-neutral-200 rounded w-20 animate-pulse"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 bg-neutral-200 rounded-full mr-1.5 animate-pulse"}),e.jsx("div",{className:"h-3 bg-neutral-200 rounded w-24 animate-pulse"})]})]})]})]}),ae=({title:t="No books yet",description:s="Start your baby's memory journey by creating your first book of precious moments and milestones.",actionLabel:i="Create Your First Book",actionLink:r="/dev/book-creator",icon:a})=>e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-col items-center justify-center py-16 px-6 text-center max-w-md mx-auto",children:[e.jsxs(c.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.1,duration:.4,ease:"easeOut"},className:"mb-6 relative",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-primary-100 to-secondary-100 rounded-full flex items-center justify-center mb-4",children:a||e.jsx(J,{className:"w-10 h-10 text-primary-500"})}),e.jsx(c.div,{animate:{y:[-2,2,-2],rotate:[0,5,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},className:"absolute -top-1 -right-1",children:e.jsx(ce,{className:"w-6 h-6 text-red-400"})})]}),e.jsx("h2",{className:"text-2xl font-bold text-neutral-800 mb-3",children:t}),e.jsx("p",{className:"text-neutral-600 leading-relaxed mb-8 max-w-sm",children:s}),r&&e.jsx(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4},children:e.jsxs(U,{to:r,className:"inline-flex items-center px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2","aria-label":i,children:[e.jsx(de,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),i]})}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[e.jsx(c.div,{animate:{x:[0,20,0],y:[0,-10,0]},transition:{duration:6,repeat:1/0,ease:"easeInOut"},className:"absolute top-1/4 left-1/4 w-2 h-2 bg-primary-200 rounded-full opacity-40"}),e.jsx(c.div,{animate:{x:[0,-15,0],y:[0,15,0]},transition:{duration:8,repeat:1/0,ease:"easeInOut",delay:1},className:"absolute bottom-1/3 right-1/4 w-1.5 h-1.5 bg-secondary-300 rounded-full opacity-50"})]})]});class at extends d.Component{constructor(){super(...arguments);H(this,"state",{hasError:!1});H(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0})})}static getDerivedStateFromError(i){return{hasError:!0,error:i}}componentDidCatch(i,r){console.error("ErrorBoundary caught an error:",i,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"flex flex-col items-center justify-center py-16 px-6 text-center max-w-md mx-auto",children:[e.jsx(c.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.1,duration:.4},className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-6",children:e.jsx(Ie,{className:"w-8 h-8 text-red-500"})}),e.jsx("h2",{className:"text-xl font-semibold text-neutral-800 mb-3",children:"Something went wrong"}),e.jsx("p",{className:"text-neutral-600 leading-relaxed mb-6",children:"We encountered an unexpected error. Please try refreshing the page or contact support if the problem persists."}),!1,e.jsxs("button",{onClick:this.handleRetry,className:"inline-flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2","aria-label":"Retry after error",children:[e.jsx(Le,{className:"w-4 h-4 mr-2"}),"Try Again"]})]}):this.props.children}}const it=({items:t})=>{const s=ke(),r=(()=>{if(t)return t;const a=s.pathname.split("/").filter(Boolean),n=[{label:"Dashboard",href:"/",icon:e.jsx(me,{className:"w-4 h-4"})}];return a.length===0||(a[0]==="book"&&a[1]&&n.push({label:"Book",href:`/book/${a[1]}`,icon:e.jsx(J,{className:"w-4 h-4"})}),a[0]==="dev"&&n.push({label:"Dev Tools",icon:e.jsx("span",{className:"text-xs",children:"🛠️"})})),n})();return r.length<=1?null:e.jsx(c.nav,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},"aria-label":"Breadcrumb navigation",className:"flex items-center space-x-2 text-sm text-neutral-600 mb-6",children:r.map((a,n)=>{const g=n===r.length-1,f=a.href&&!g;return e.jsxs(le.Fragment,{children:[n>0&&e.jsx(ue,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),e.jsxs(c.div,{initial:{opacity:0,x:-5},animate:{opacity:1,x:0},transition:{delay:n*.1,duration:.2},className:"flex items-center space-x-1.5",children:[a.icon&&e.jsx("span",{className:"text-neutral-500 flex-shrink-0",children:a.icon}),f?e.jsx(U,{to:a.href,className:"hover:text-primary-600 transition-colors truncate","aria-label":`Go to ${a.label}`,children:a.label}):e.jsx("span",{className:`truncate ${g?"text-neutral-800 font-medium":""}`,"aria-current":g?"page":void 0,children:a.label})]})]},n)})})},rt=()=>{const{books:t,isLoading:s}=G(),[i,r]=d.useState([]),[a,n]=d.useState(""),[g,f]=d.useState(!1);d.useEffect(()=>{if(!a.trim()){r(t);return}const u=t.filter(o=>{var l;return o.title.toLowerCase().includes(a.toLowerCase())||o.description.toLowerCase().includes(a.toLowerCase())||((l=o.metadata.babyName)==null?void 0:l.toLowerCase().includes(a.toLowerCase()))});r(u)},[t,a]);const w=u=>{n(u.target.value)};return e.jsx(at,{children:e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"min-h-screen p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx(it,{}),e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},className:"mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"w-8 h-8 text-primary-500 mr-3"}),e.jsx(ce,{className:"w-5 h-5 text-red-400 animate-bounce-gentle"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-neutral-800",children:"My Baby Books"}),e.jsx("p",{className:"text-neutral-600 mt-1",children:s?"Loading...":`${i.length} ${i.length===1?"book":"books"}`})]})]}),e.jsxs(U,{to:"/dev/book-creator",className:"inline-flex items-center px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:[e.jsx(de,{className:"w-5 h-5 mr-2"}),"New Book"]})]}),(t.length>0||a)&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),e.jsx("input",{type:"text",placeholder:"Search books by title, description, or baby name...",value:a,onChange:w,className:"w-full pl-10 pr-4 py-2.5 border border-neutral-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all bg-white/50 backdrop-blur-sm"})]}),e.jsxs("button",{onClick:()=>f(!g),className:"flex items-center px-4 py-2.5 border border-neutral-200 rounded-lg hover:bg-neutral-50 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:[e.jsx(Re,{className:"w-5 h-5 mr-2 text-neutral-500"}),"Filters"]})]})]}),s?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Array.from({length:8}).map((u,o)=>e.jsx(st,{index:o},o))}):i.length===0?a?e.jsx(ae,{title:"No books found",description:`No books match your search for "${a}". Try adjusting your search terms or create a new book.`,actionLabel:"Create New Book",actionLink:"/dev/book-creator",icon:e.jsx(ee,{className:"w-10 h-10 text-primary-500"})}):e.jsx(ae,{}):e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2,duration:.5},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:i.map((u,o)=>e.jsx(tt,{book:u,index:o},u.id))}),a&&i.length>0&&e.jsxs(c.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},className:"mt-8 text-center text-neutral-600",children:["Found ",i.length," ",i.length===1?"book":"books",' matching "',a,'"']})]})})})},nt="Left",ot="Right",lt="Up",ct="Down",L={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},$={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},ie="mousemove",re="mouseup",dt="touchend",ut="touchmove",mt="touchstart";function ht(t,s,i,r){return t>s?i>0?ot:nt:r>0?ct:lt}function ne(t,s){if(s===0)return t;const i=Math.PI/180*s,r=t[0]*Math.cos(i)+t[1]*Math.sin(i),a=t[1]*Math.cos(i)-t[0]*Math.sin(i);return[r,a]}function xt(t,s){const i=o=>{const l="touches"in o;l&&o.touches.length>1||t((m,x)=>{x.trackMouse&&!l&&(document.addEventListener(ie,r),document.addEventListener(re,g));const{clientX:p,clientY:y}=l?o.touches[0]:o,N=ne([p,y],x.rotationAngle);return x.onTouchStartOrOnMouseDown&&x.onTouchStartOrOnMouseDown({event:o}),Object.assign(Object.assign(Object.assign({},m),$),{initial:N.slice(),xy:N,start:o.timeStamp||0})})},r=o=>{t((l,m)=>{const x="touches"in o;if(x&&o.touches.length>1)return l;if(o.timeStamp-l.start>m.swipeDuration)return l.swiping?Object.assign(Object.assign({},l),{swiping:!1}):l;const{clientX:p,clientY:y}=x?o.touches[0]:o,[N,S]=ne([p,y],m.rotationAngle),b=N-l.xy[0],k=S-l.xy[1],O=Math.abs(b),j=Math.abs(k),C=(o.timeStamp||0)-l.start,B=Math.sqrt(O*O+j*j)/(C||1),T=[b/(C||1),k/(C||1)],P=ht(O,j,b,k),I=typeof m.delta=="number"?m.delta:m.delta[P.toLowerCase()]||L.delta;if(O<I&&j<I&&!l.swiping)return l;const R={absX:O,absY:j,deltaX:b,deltaY:k,dir:P,event:o,first:l.first,initial:l.initial,velocity:B,vxvy:T};R.first&&m.onSwipeStart&&m.onSwipeStart(R),m.onSwiping&&m.onSwiping(R);let E=!1;return(m.onSwiping||m.onSwiped||m[`onSwiped${P}`])&&(E=!0),E&&m.preventScrollOnSwipe&&m.trackTouch&&o.cancelable&&o.preventDefault(),Object.assign(Object.assign({},l),{first:!1,eventData:R,swiping:!0})})},a=o=>{t((l,m)=>{let x;if(l.swiping&&l.eventData){if(o.timeStamp-l.start<m.swipeDuration){x=Object.assign(Object.assign({},l.eventData),{event:o}),m.onSwiped&&m.onSwiped(x);const p=m[`onSwiped${x.dir}`];p&&p(x)}}else m.onTap&&m.onTap({event:o});return m.onTouchEndOrOnMouseUp&&m.onTouchEndOrOnMouseUp({event:o}),Object.assign(Object.assign(Object.assign({},l),$),{eventData:x})})},n=()=>{document.removeEventListener(ie,r),document.removeEventListener(re,g)},g=o=>{n(),a(o)},f=(o,l)=>{let m=()=>{};if(o&&o.addEventListener){const x=Object.assign(Object.assign({},L.touchEventOptions),l.touchEventOptions),p=[[mt,i,x],[ut,r,Object.assign(Object.assign({},x),l.preventScrollOnSwipe?{passive:!1}:{})],[dt,a,x]];p.forEach(([y,N,S])=>o.addEventListener(y,N,S)),m=()=>p.forEach(([y,N])=>o.removeEventListener(y,N))}return m},u={ref:o=>{o!==null&&t((l,m)=>{if(l.el===o)return l;const x={};return l.el&&l.el!==o&&l.cleanUpTouch&&(l.cleanUpTouch(),x.cleanUpTouch=void 0),m.trackTouch&&o&&(x.cleanUpTouch=f(o,m)),Object.assign(Object.assign(Object.assign({},l),{el:o}),x)})}};return s.trackMouse&&(u.onMouseDown=i),[u,f]}function ft(t,s,i,r){return!s.trackTouch||!t.el?(t.cleanUpTouch&&t.cleanUpTouch(),Object.assign(Object.assign({},t),{cleanUpTouch:void 0})):t.cleanUpTouch?s.preventScrollOnSwipe!==i.preventScrollOnSwipe||s.touchEventOptions.passive!==i.touchEventOptions.passive?(t.cleanUpTouch(),Object.assign(Object.assign({},t),{cleanUpTouch:r(t.el,s)})):t:Object.assign(Object.assign({},t),{cleanUpTouch:r(t.el,s)})}function pt(t){const{trackMouse:s}=t,i=d.useRef(Object.assign({},$)),r=d.useRef(Object.assign({},L)),a=d.useRef(Object.assign({},r.current));a.current=Object.assign({},r.current),r.current=Object.assign(Object.assign({},L),t);let n;for(n in L)r.current[n]===void 0&&(r.current[n]=L[n]);const[g,f]=d.useMemo(()=>xt(w=>i.current=w(i.current,r.current),{trackMouse:s}),[s]);return i.current=ft(i.current,r.current,a.current,f),g}const gt=()=>{const{bookId:t}=Oe(),s=Te(),{books:i,settings:r,setSettings:a}=G(),[n,g]=d.useState(null),[f,w]=d.useState(0),[u,o]=d.useState(!1),[l]=d.useState(3e3),[m,x]=d.useState(!0),[p,y]=d.useState(!1),[N,S]=d.useState(0),[b,k]=d.useState(null),[O,j]=d.useState(null),[C,B]=d.useState(null),T=d.useRef(null),P=d.useRef(null),I=r.enableSounds,E=window.matchMedia("(prefers-reduced-motion: reduce)").matches?200:650,V=[.77,0,.175,1],Y=[.33,1,.68,1];d.useEffect(()=>{if(t&&i.length>0){const h=i.find(v=>v.id===t);h?g(h):s("/404")}},[t,i,s]);const q=()=>{try{const h=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmMdAJJAf2j9+8pUGwo6nNvhpF0OBEWr2+XMeUcNI3fU8OOlZ0MRLNzv1JJAIxE5nuvgmV8PBDuj6vKoeFEWY4DV8t2MUBoBH4jV8OfNuFYUC5XP3Z5+SQkVKYDa3Z9QGgEfnvXdpEsOFI7V8d2QPwUQdcvz4pZJGgozlNfhpVEOBkir2+PNekkLK3rS69qXWBAOJpnO3qJQEgc7n97gqF0PBEij2+XNeUoOJ3rJ8NqVXBELJJvV3qdUEQcshOXuwmgiDTiR2OzLgGYZBzOJ1+e8Z0AJXrfn5b9RLwYqh8vmwGFGBSeh4veualEJNZzV5Z5wSgQcjdrjxGU5CTWZze2vZzIEHYTa5L9SNgcpidflvmlOBCCY1+mxY0MJNZ7P6ateLgUug9jnwmlRBSKR2+zLfGASEm/F8d2QQREUJqfh9baLSTQHOZPW4qFbGAoqhtvmunBUDBKX2+bDYUEHLIHa5bhiOAcx");h.volume=.1,h.play().catch(()=>{})}catch{}},F=d.useCallback(()=>{if(!n||p)return;const h=(f+1)%n.pages.length;h===0&&u&&o(!1),y(!0),k("next"),B(h),I&&q(),setTimeout(()=>{w(h),setTimeout(()=>{y(!1),k(null),B(null)},20)},E)},[n,p,f,u,I]);d.useEffect(()=>{if(u&&n&&n.pages.length>1){M(),S(0);const h=100/(l/50);P.current=setInterval(()=>{S(v=>v>=100?0:v+h)},50),T.current=setTimeout(()=>{F()},l)}else M();return()=>M()},[u,f,l,n,F]);const M=()=>{T.current&&(clearTimeout(T.current),T.current=null),P.current&&(clearInterval(P.current),P.current=null),S(0)},Z=()=>{if(!n||p)return;const h=f===0?n.pages.length-1:f-1;y(!0),k("prev"),j(h),I&&q(),setTimeout(()=>{w(h),setTimeout(()=>{y(!1),k(null),j(null)},20)},E)},ge=pt({onSwipedLeft:()=>!p&&F(),onSwipedRight:()=>!p&&Z(),preventScrollOnSwipe:!0,trackMouse:!0,trackTouch:!0,delta:10}),be=()=>{o(!u),u&&M()},ye=()=>{x(!m),setTimeout(()=>x(!0),3e3)},_=(h,v=!0)=>{var W,K;return e.jsxs(e.Fragment,{children:[h.media&&h.media.length>0&&e.jsx("div",{className:"absolute inset-1 flex items-center justify-center pt-16 pb-16",children:e.jsx(c.img,{src:h.media[0].url,alt:h.media[0].altText||h.title,style:{height:"fit-content",maxHeight:"100vh",borderRadius:"12px",inset:"0.25rem"},className:"w-full h-full object-contain",initial:v?{scale:1.1,opacity:0}:{},animate:v?{scale:1,opacity:1}:{},transition:{duration:.8}})}),e.jsx(c.div,{initial:v?{y:20,opacity:0}:{},animate:v?{y:0,opacity:1}:{},transition:{delay:.3},className:"absolute bottom-20 left-4 right-4 z-30",children:e.jsxs("div",{className:"",children:[e.jsx("h2",{className:"text-lg font-bold text-white drop-shadow-lg",children:h.title}),e.jsx("p",{className:"text-xs text-white/80 mt-1 drop-shadow-sm",children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),h.content&&e.jsx(c.div,{initial:v?{x:20,opacity:0}:{},animate:v?{x:0,opacity:1}:{},transition:{delay:.4},className:"absolute top-1/2 right-4 transform -translate-y-1/2 z-30 max-w-xs",children:e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-lg px-3 py-2 border border-white/20 shadow-2xl",children:e.jsx("div",{className:"text-white text-xs leading-relaxed drop-shadow-sm",children:h.content})})}),h.media&&((W=h.media[0])==null?void 0:W.caption)&&e.jsx(c.div,{initial:v?{y:-20,opacity:0}:{},animate:v?{y:0,opacity:1}:{},transition:{delay:.5},className:"absolute top-20 left-4 z-30",children:e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-lg px-3 py-2 border border-white/20 shadow-2xl",children:e.jsx("p",{className:"text-white/90 text-xs italic drop-shadow-sm",children:(K=h.media[0])==null?void 0:K.caption})})}),h.tags.length>0&&e.jsx(c.div,{initial:v?{y:-20,opacity:0}:{},animate:v?{y:0,opacity:1}:{},transition:{delay:.6},className:"absolute top-20 right-4 z-30",children:e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-lg px-3 py-2 border border-white/20 shadow-2xl",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:h.tags.map((we,je)=>e.jsxs("span",{className:"px-2 py-0.5 bg-white/20 text-white rounded-full text-xs font-medium border border-white/30",children:["#",we]},je))})})})]})};if(!n)return e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"text-neutral-600",children:"Loading book..."})]})});const D=n.pages[f];return e.jsxs(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"min-h-screen relative overflow-hidden",onClick:ye,children:[e.jsx("div",{className:"fixed inset-0 z-0",children:D.media&&D.media.length>0?e.jsxs(e.Fragment,{children:[e.jsx(c.img,{src:D.media[0].url,alt:"",className:"w-full h-full object-cover",style:{filter:"blur(12px)",transform:"scale(1.2)"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.8}}),e.jsx("div",{className:"absolute inset-0 bg-black/30"})]}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-primary-50 via-secondary-50 to-neutral-100"})}),e.jsx(X,{mode:"wait",children:m&&e.jsx(c.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},transition:{duration:.3},className:"absolute top-0 left-0 right-0 z-30 bg-gradient-to-b from-black/20 to-transparent",children:e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>s("/books"),className:"flex items-center gap-1 px-2 py-1 bg-white/20 backdrop-blur-md rounded-full shadow-lg hover:bg-white/30 transition-colors border border-white/20",children:[e.jsx(he,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-medium text-white",children:"Back"})]}),e.jsxs("div",{className:"text-center text-white",children:[e.jsx("h1",{className:"text-sm font-bold drop-shadow-lg",children:n.title}),e.jsxs("p",{className:"text-xs opacity-80",children:[f+1,"/",n.pages.length]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>a({...r,enableSounds:!r.enableSounds}),className:"p-1.5 bg-white/20 backdrop-blur-md rounded-full shadow-lg hover:bg-white/30 transition-colors border border-white/20",children:r.enableSounds?e.jsx(De,{className:"w-3 h-3 text-white"}):e.jsx(Ue,{className:"w-3 h-3 text-white"})}),e.jsxs(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:be,className:"flex items-center gap-1 px-2 py-1 bg-white/20 backdrop-blur-md rounded-full shadow-lg hover:bg-white/30 transition-colors border border-white/20",children:[u?e.jsx(Fe,{className:"w-3 h-3 text-white"}):e.jsx(Me,{className:"w-3 h-3 text-white"}),e.jsx("span",{className:"text-xs font-medium text-white",children:u?"Pause":"Auto"})]})]})]})})}),u&&e.jsx(c.div,{className:"absolute top-16 left-4 right-4 z-30 bg-white/20 backdrop-blur-md rounded-full h-1 overflow-hidden border border-white/20",initial:{opacity:0},animate:{opacity:1},children:e.jsx(c.div,{className:"h-full bg-white",style:{width:`${N}%`},transition:{duration:.1}})}),e.jsx("div",{...ge,className:"relative h-screen flex items-center justify-center z-10",children:e.jsxs(c.div,{className:"relative w-full h-full z-20",children:[e.jsx("div",{className:"absolute inset-0 w-full h-full overflow-hidden",style:{zIndex:4},children:b==="next"&&C!==null?_(n.pages[C],!1):_(D,b===null)}),b==="next"&&e.jsx(c.div,{className:"absolute inset-0 w-full h-full overflow-hidden",style:{transformOrigin:"left center",zIndex:10},initial:{scaleX:1,x:0},animate:{scaleX:.05,x:"-10%"},transition:{scaleX:{duration:E/1e3,ease:V},x:{duration:E/1e3,ease:Y}},children:e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[_(D,!1),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 w-1/5 bg-gradient-to-r from-black/25 to-transparent"})]})},"next-shrink"),b==="prev"&&O!==null&&e.jsx(c.div,{className:"absolute inset-0 w-full h-full overflow-hidden",style:{transformOrigin:"left center",zIndex:10},initial:{scaleX:.05,x:"-10%"},animate:{scaleX:1,x:0},transition:{scaleX:{duration:E/1e3,ease:V},x:{duration:E/1e3,ease:Y}},children:e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[_(n.pages[O],!1),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 w-1/5 bg-gradient-to-r from-black/25 to-transparent"})]})},"prev-expand")]})}),e.jsx(X,{children:m&&e.jsx(c.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},transition:{duration:.3},className:"absolute bottom-0 left-0 right-0 z-30 bg-gradient-to-t from-black/20 to-transparent",children:e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Z,disabled:p,className:"flex items-center gap-1 px-2 py-1 bg-white/20 backdrop-blur-md rounded-full shadow-lg hover:bg-white/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed border border-white/20",children:[e.jsx(_e,{className:"w-3 h-3 text-white"}),e.jsx("span",{className:"text-xs font-medium text-white",children:"Previous"})]}),e.jsx("div",{className:"flex items-center gap-1",children:n.pages.map((h,v)=>e.jsx(c.button,{whileHover:{scale:1.2},whileTap:{scale:.8},onClick:()=>!p&&w(v),className:`w-2 h-2 rounded-full transition-colors ${v===f?"bg-white border border-white/50":"bg-white/30 hover:bg-white/50 border border-white/20"}`},v))}),e.jsxs(c.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:F,disabled:p,className:"flex items-center gap-1 px-2 py-1 bg-white/20 backdrop-blur-md rounded-full shadow-lg hover:bg-white/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed border border-white/20",children:[e.jsx("span",{className:"text-xs font-medium text-white",children:"Next"}),e.jsx(ue,{className:"w-3 h-3 text-white"})]})]})})})]})},oe=()=>e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"min-h-screen p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-800 mb-8",children:"Edit Book"}),e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-neutral-600",children:"Book editing functionality will be implemented next."})})]})}),bt=()=>e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"min-h-screen p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-800 mb-8",children:"Settings"}),e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-neutral-600",children:"Settings functionality will be implemented next."})})]})}),yt=()=>e.jsx(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"min-h-screen flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs(c.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.2,duration:.5},className:"mb-8",children:[e.jsx("div",{className:"text-8xl font-bold text-primary-500 mb-4",children:"404"}),e.jsx("h1",{className:"text-2xl font-bold text-neutral-800 mb-2",children:"Page Not Found"}),e.jsx("p",{className:"text-neutral-600",children:"The page you're looking for doesn't exist or has been moved."})]}),e.jsxs(c.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},className:"space-y-4",children:[e.jsxs(U,{to:"/",className:"inline-flex items-center px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-semibold",children:[e.jsx(me,{className:"w-5 h-5 mr-2"}),"Go Home"]}),e.jsx("div",{children:e.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center px-6 py-3 bg-neutral-200 text-neutral-800 rounded-lg hover:bg-neutral-300 transition-colors font-semibold",children:[e.jsx(he,{className:"w-5 h-5 mr-2"}),"Go Back"]})})]})]})});function wt(){const[t,s]=d.useState([]),[i,r]=d.useState(null),[a,n]=d.useState(null),[g,f]=d.useState(se),[w,u]=d.useState(!0),[o,l]=d.useState(null);d.useEffect(()=>{(async()=>{try{u(!0);const p=localStorage.getItem("baby-book-settings");if(p){const y=JSON.parse(p);f({...se,...y})}try{const y=await fetch("/baby-book/books-manifest.json");if(y.ok){const S=(await y.json()).books.map(b=>{var k,O;return{id:b.id,title:b.title,description:b.description||"",coverImage:b.coverImage?{id:`cover-${b.id}`,type:"image",url:b.coverImage.src,thumbnailUrl:(O=(k=b.coverImage.srcSet)==null?void 0:k.webp)==null?void 0:O.split(" ")[0],altText:b.coverImage.alt||b.title,metadata:{width:b.coverImage.width,height:b.coverImage.height},uploadedAt:new Date}:void 0,pages:b.pages.map((j,C)=>{var B,T;return{id:j.id,bookId:b.id,title:j.title,content:j.description||"",media:j.image?[{id:`media-${j.id}`,type:"image",url:j.image.src,thumbnailUrl:(T=(B=j.image.srcSet)==null?void 0:B.webp)==null?void 0:T.split(" ")[0],altText:j.image.alt||j.title,metadata:{width:j.image.width,height:j.image.height},uploadedAt:new Date}]:[],dateCreated:new Date,dateModified:new Date,pageNumber:j.pageNumber||C+1,layout:"single-photo",tags:[]}}),dateCreated:new Date,dateModified:new Date,isPublic:!1,totalPages:b.pages.length,theme:{primaryColor:"#3B82F6",secondaryColor:"#F59E0B",fontFamily:"Inter",pageStyle:"modern"},metadata:{babyName:b.title,tags:[]}}});s(S)}else{const N=localStorage.getItem("baby-book-books");if(N){const S=JSON.parse(N);s(S)}}}catch(y){console.error("Failed to load books:",y);const N=localStorage.getItem("baby-book-books");if(N){const S=JSON.parse(N);s(S)}}await new Promise(y=>setTimeout(y,800))}catch(p){l("Failed to load application data"),console.error("Failed to load initial data:",p)}finally{u(!1)}})()},[]),d.useEffect(()=>{if(t.length>0){const x=localStorage.getItem("baby-book-last-book");if(x){const p=t.find(y=>y.id===x);p&&r(p)}}},[t]);const m={books:t,setBooks:s,currentBook:i,setCurrentBook:r,user:a,setUser:n,settings:g,setSettings:f,isLoading:w,setIsLoading:u,error:o,setError:l};return w?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 flex items-center justify-center",children:e.jsxs(c.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},className:"text-center",children:[e.jsx(c.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-primary-200 border-t-primary-500 rounded-full mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-neutral-800 mb-2",children:"Loading Baby Book"}),e.jsx("p",{className:"text-neutral-600",children:"Preparing your precious memories..."})]})}):o?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50 flex items-center justify-center",children:e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center p-8 max-w-md",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-red-500 text-2xl",children:"⚠️"})}),e.jsx("h2",{className:"text-xl font-semibold text-neutral-800 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-neutral-600 mb-6",children:o}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Reload App"})]})}):e.jsx(Ye,{value:m,children:e.jsx(Ze,{children:e.jsx(Ke,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-secondary-50",children:e.jsx(et,{children:e.jsx(X,{mode:"wait",children:e.jsxs(Ee,{children:[e.jsx(A,{path:"/",element:e.jsx(rt,{})}),e.jsx(A,{path:"/book/:bookId",element:e.jsx(gt,{})}),e.jsx(A,{path:"/book/:bookId/edit",element:e.jsx(oe,{})}),e.jsx(A,{path:"/dev/book-creator",element:e.jsx(oe,{})}),e.jsx(A,{path:"/settings",element:e.jsx(bt,{})}),e.jsx(A,{path:"/404",element:e.jsx(yt,{})}),e.jsx(A,{path:"*",element:e.jsx(Ce,{to:"/404",replace:!0})})]})})})})})})})}const jt=new Je({defaultOptions:{queries:{staleTime:5*60*1e3,refetchOnWindowFocus:!1,retry:3},mutations:{retry:1}}});Q.createRoot(document.getElementById("root")).render(e.jsx(le.StrictMode,{children:e.jsx(Pe,{basename:"/baby-book",children:e.jsx(ze,{client:jt,children:e.jsx(wt,{})})})}));
