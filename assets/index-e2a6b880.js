var Oe=Object.defineProperty;var Te=(t,s,r)=>s in t?Oe(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var Z=(t,s,r)=>(Te(t,typeof s!="symbol"?s+"":s,r),r);import{r as l,b as Ee,a as xe}from"./vendor-92c95717.js";import{L as X,u as Pe,a as Ce,b as Ie,R as Ae,c as U,N as Be,B as Le}from"./router-adb422dd.js";import{m as d,A as W}from"./motion-6ca97e44.js";import{B as Y,U as Re,C as De,H as fe,P as pe,A as Ue,R as Fe,a as ge,b as be,S as ie,F as Me,c as ye,V as _e,d as Je,e as ze,f as He,g as Xe}from"./icons-1d13e935.js";import{Q as $e,a as Qe}from"./query-3801a2c7.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const b of a.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&i(b)}).observe(document,{childList:!0,subtree:!0});function r(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=r(n);fetch(n.href,a)}})();var we={exports:{}},q={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ge=l,Ve=Symbol.for("react.element"),Ye=Symbol.for("react.fragment"),qe=Object.prototype.hasOwnProperty,Ze=Ge.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,We={key:!0,ref:!0,__self:!0,__source:!0};function je(t,s,r){var i,n={},a=null,b=null;r!==void 0&&(a=""+r),s.key!==void 0&&(a=""+s.key),s.ref!==void 0&&(b=s.ref);for(i in s)qe.call(s,i)&&!We.hasOwnProperty(i)&&(n[i]=s[i]);if(t&&t.defaultProps)for(i in s=t.defaultProps,s)n[i]===void 0&&(n[i]=s[i]);return{$$typeof:Ve,type:t,key:a,ref:b,props:n,_owner:Ze.current}}q.Fragment=Ye;q.jsx=je;q.jsxs=je;we.exports=q;var e=we.exports,K={},oe=Ee;K.createRoot=oe.createRoot,K.hydrateRoot=oe.hydrateRoot;const le={theme:"system",autoSave:!0,autoSaveInterval:3e4,defaultPageLayout:"single-photo",showTutorial:!0,enableSounds:!0,enableAnimations:!0,preferredLanguage:"en",privacySettings:{allowAnalytics:!1,allowCrashReporting:!0}},ve=l.createContext(void 0),Ke=({value:t,children:s})=>e.jsx(ve.Provider,{value:t,children:s}),te=()=>{const t=l.useContext(ve);if(t===void 0)throw new Error("useApp must be used within an AppProvider");return t},et=l.createContext(void 0),tt=({children:t})=>{const{settings:s,setSettings:r}=te(),[i,n]=l.useState("light");l.useEffect(()=>{const j=()=>{if(s.theme==="system"){const m=window.matchMedia("(prefers-color-scheme: dark)").matches;n(m?"dark":"light")}else n(s.theme)};if(j(),s.theme==="system"){const m=window.matchMedia("(prefers-color-scheme: dark)");return m.addEventListener("change",j),()=>m.removeEventListener("change",j)}},[s.theme]),l.useEffect(()=>{document.documentElement.classList.toggle("dark",i==="dark")},[i]);const a=j=>{const m={...s,theme:j};r(m),localStorage.setItem("baby-book-settings",JSON.stringify(m))},b=()=>{s.theme==="light"?a("dark"):s.theme==="dark"?a("system"):a("light")},x={theme:s.theme,effectiveTheme:i,setTheme:a,toggleTheme:b};return e.jsx(et.Provider,{value:x,children:t})},st=l.createContext(void 0),at=({children:t})=>{const[s,r]=l.useState([]),i=l.useCallback(x=>{const j={...x,id:crypto.randomUUID(),timestamp:new Date};r(o=>[...o,j]);const m=x.duration??5e3;m>0&&setTimeout(()=>{r(o=>o.filter(c=>c.id!==j.id))},m)},[]),n=l.useCallback(x=>{r(j=>j.filter(m=>m.id!==x))},[]),a=l.useCallback(()=>{r([])},[]),b={notifications:s,addNotification:i,removeNotification:n,clearNotifications:a};return e.jsx(st.Provider,{value:b,children:t})},nt=({children:t,className:s=""})=>e.jsx("div",{className:`min-h-screen flex flex-col ${s}`,children:e.jsx(d.main,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"flex-1",children:t})}),rt=({book:t,index:s=0})=>{const r=i=>new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(new Date(i));return e.jsx(d.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.4,delay:s*.1,ease:[.25,.46,.45,.94]},whileHover:{y:-8,scale:1.02,transition:{duration:.2}},whileTap:{scale:.98},className:"group cursor-pointer",children:e.jsxs(X,{to:`/book/${t.id}`,className:"block bg-white rounded-xl shadow-sm hover:shadow-lg transition-all duration-200 overflow-hidden border border-neutral-100 hover:border-primary-200","aria-label":`View ${t.title} - Created ${r(t.dateCreated)}`,children:[e.jsxs("div",{className:"relative aspect-[4/3] bg-gradient-to-br from-primary-50 to-secondary-50 overflow-hidden",children:[t.coverImage?e.jsx("img",{src:t.coverImage.url,alt:t.coverImage.altText||`Cover of ${t.title}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gradient-to-br from-primary-100 to-secondary-100",children:e.jsx(Y,{className:"w-16 h-16 text-primary-400 group-hover:text-primary-500 transition-colors","aria-hidden":"true"})}),e.jsxs("div",{className:"absolute top-3 right-3 bg-white/90 backdrop-blur-sm rounded-full px-2 py-1 text-xs font-medium text-neutral-700 shadow-sm",children:[t.totalPages," ",t.totalPages===1?"page":"pages"]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-neutral-800 mb-1 line-clamp-1 group-hover:text-primary-600 transition-colors",children:t.title}),e.jsx("p",{className:"text-sm text-neutral-600 line-clamp-2 leading-relaxed",children:t.description||"A collection of precious memories and moments."})]}),e.jsxs("div",{className:"space-y-2",children:[t.metadata.babyName&&e.jsxs("div",{className:"flex items-center text-xs text-neutral-500",children:[e.jsx(Re,{className:"w-3 h-3 mr-1.5 flex-shrink-0","aria-hidden":"true"}),e.jsx("span",{className:"truncate",children:t.metadata.babyName})]}),e.jsxs("div",{className:"flex items-center text-xs text-neutral-500",children:[e.jsx(De,{className:"w-3 h-3 mr-1.5 flex-shrink-0","aria-hidden":"true"}),e.jsxs("span",{children:["Created ",r(t.dateCreated)]})]})]})]}),e.jsx("div",{className:"absolute inset-0 bg-primary-500/0 group-hover:bg-primary-500/5 transition-colors duration-200 pointer-events-none"})]})})},it=({index:t=0})=>e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:t*.05},className:"bg-white rounded-xl shadow-sm border border-neutral-100 overflow-hidden",children:[e.jsxs("div",{className:"relative aspect-[4/3] bg-gradient-to-br from-neutral-100 to-neutral-150 animate-pulse",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent -skew-x-12 animate-shimmer"}),e.jsx("div",{className:"absolute top-3 right-3 bg-neutral-200 rounded-full px-2 py-1 animate-pulse",children:e.jsx("div",{className:"h-3 w-12 bg-neutral-300 rounded"})})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"h-5 bg-neutral-200 rounded animate-pulse"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"h-4 bg-neutral-150 rounded w-full animate-pulse"}),e.jsx("div",{className:"h-4 bg-neutral-150 rounded w-3/4 animate-pulse"})]})]}),e.jsxs("div",{className:"space-y-2 pt-1",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 bg-neutral-200 rounded-full mr-1.5 animate-pulse"}),e.jsx("div",{className:"h-3 bg-neutral-200 rounded w-20 animate-pulse"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"h-3 w-3 bg-neutral-200 rounded-full mr-1.5 animate-pulse"}),e.jsx("div",{className:"h-3 bg-neutral-200 rounded w-24 animate-pulse"})]})]})]})]}),ce=({title:t="No books yet",description:s="Start your baby's memory journey by creating your first book of precious moments and milestones.",actionLabel:r="Create Your First Book",actionLink:i="/dev/book-creator",icon:n})=>e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-col items-center justify-center py-16 px-6 text-center max-w-md mx-auto",children:[e.jsxs(d.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.1,duration:.4,ease:"easeOut"},className:"mb-6 relative",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-primary-100 to-secondary-100 rounded-full flex items-center justify-center mb-4",children:n||e.jsx(Y,{className:"w-10 h-10 text-primary-500"})}),e.jsx(d.div,{animate:{y:[-2,2,-2],rotate:[0,5,-5,0]},transition:{duration:3,repeat:1/0,ease:"easeInOut"},className:"absolute -top-1 -right-1",children:e.jsx(fe,{className:"w-6 h-6 text-red-400"})})]}),e.jsx("h2",{className:"text-2xl font-bold text-neutral-800 mb-3",children:t}),e.jsx("p",{className:"text-neutral-600 leading-relaxed mb-8 max-w-sm",children:s}),i&&e.jsx(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.4},children:e.jsxs(X,{to:i,className:"inline-flex items-center px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2","aria-label":r,children:[e.jsx(pe,{className:"w-5 h-5 mr-2","aria-hidden":"true"}),r]})}),e.jsxs("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[e.jsx(d.div,{animate:{x:[0,20,0],y:[0,-10,0]},transition:{duration:6,repeat:1/0,ease:"easeInOut"},className:"absolute top-1/4 left-1/4 w-2 h-2 bg-primary-200 rounded-full opacity-40"}),e.jsx(d.div,{animate:{x:[0,-15,0],y:[0,15,0]},transition:{duration:8,repeat:1/0,ease:"easeInOut",delay:1},className:"absolute bottom-1/3 right-1/4 w-1.5 h-1.5 bg-secondary-300 rounded-full opacity-50"})]})]});class ot extends l.Component{constructor(){super(...arguments);Z(this,"state",{hasError:!1});Z(this,"handleRetry",()=>{this.setState({hasError:!1,error:void 0})})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,i){console.error("ErrorBoundary caught an error:",r,i)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"flex flex-col items-center justify-center py-16 px-6 text-center max-w-md mx-auto",children:[e.jsx(d.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.1,duration:.4},className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-6",children:e.jsx(Ue,{className:"w-8 h-8 text-red-500"})}),e.jsx("h2",{className:"text-xl font-semibold text-neutral-800 mb-3",children:"Something went wrong"}),e.jsx("p",{className:"text-neutral-600 leading-relaxed mb-6",children:"We encountered an unexpected error. Please try refreshing the page or contact support if the problem persists."}),!1,e.jsxs("button",{onClick:this.handleRetry,className:"inline-flex items-center px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2","aria-label":"Retry after error",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Try Again"]})]}):this.props.children}}const lt=({items:t})=>{const s=Pe(),i=(()=>{if(t)return t;const n=s.pathname.split("/").filter(Boolean),a=[{label:"Dashboard",href:"/",icon:e.jsx(be,{className:"w-4 h-4"})}];return n.length===0||(n[0]==="book"&&n[1]&&a.push({label:"Book",href:`/book/${n[1]}`,icon:e.jsx(Y,{className:"w-4 h-4"})}),n[0]==="dev"&&a.push({label:"Dev Tools",icon:e.jsx("span",{className:"text-xs",children:"🛠️"})})),a})();return i.length<=1?null:e.jsx(d.nav,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3},"aria-label":"Breadcrumb navigation",className:"flex items-center space-x-2 text-sm text-neutral-600 mb-6",children:i.map((n,a)=>{const b=a===i.length-1,x=n.href&&!b;return e.jsxs(xe.Fragment,{children:[a>0&&e.jsx(ge,{className:"w-4 h-4 text-neutral-400 flex-shrink-0"}),e.jsxs(d.div,{initial:{opacity:0,x:-5},animate:{opacity:1,x:0},transition:{delay:a*.1,duration:.2},className:"flex items-center space-x-1.5",children:[n.icon&&e.jsx("span",{className:"text-neutral-500 flex-shrink-0",children:n.icon}),x?e.jsx(X,{to:n.href,className:"hover:text-primary-600 transition-colors truncate","aria-label":`Go to ${n.label}`,children:n.label}):e.jsx("span",{className:`truncate ${b?"text-neutral-800 font-medium":""}`,"aria-current":b?"page":void 0,children:n.label})]})]},a)})})},ct=()=>{const{books:t,isLoading:s}=te(),[r,i]=l.useState([]),[n,a]=l.useState(""),[b,x]=l.useState(!1);l.useEffect(()=>{if(!n.trim()){i(t);return}const m=t.filter(o=>{var c;return o.title.toLowerCase().includes(n.toLowerCase())||o.description.toLowerCase().includes(n.toLowerCase())||((c=o.metadata.babyName)==null?void 0:c.toLowerCase().includes(n.toLowerCase()))});i(m)},[t,n]);const j=m=>{a(m.target.value)};return e.jsx(ot,{children:e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"min-h-screen p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx(lt,{}),e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},className:"mb-8",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"w-8 h-8 text-primary-500 mr-3"}),e.jsx(fe,{className:"w-5 h-5 text-red-400 animate-bounce-gentle"})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-neutral-800",children:"My Baby Books"}),e.jsx("p",{className:"text-neutral-600 mt-1",children:s?"Loading...":`${r.length} ${r.length===1?"book":"books"}`})]})]}),e.jsxs(X,{to:"/dev/book-creator",className:"inline-flex items-center px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:[e.jsx(pe,{className:"w-5 h-5 mr-2"}),"New Book"]})]}),(t.length>0||n)&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-neutral-400"}),e.jsx("input",{type:"text",placeholder:"Search books by title, description, or baby name...",value:n,onChange:j,className:"w-full pl-10 pr-4 py-2.5 border border-neutral-200 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent transition-all bg-white/50 backdrop-blur-sm"})]}),e.jsxs("button",{onClick:()=>x(!b),className:"flex items-center px-4 py-2.5 border border-neutral-200 rounded-lg hover:bg-neutral-50 transition-colors focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:[e.jsx(Me,{className:"w-5 h-5 mr-2 text-neutral-500"}),"Filters"]})]})]}),s?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:Array.from({length:8}).map((m,o)=>e.jsx(it,{index:o},o))}):r.length===0?n?e.jsx(ce,{title:"No books found",description:`No books match your search for "${n}". Try adjusting your search terms or create a new book.`,actionLabel:"Create New Book",actionLink:"/dev/book-creator",icon:e.jsx(ie,{className:"w-10 h-10 text-primary-500"})}):e.jsx(ce,{}):e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2,duration:.5},className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:r.map((m,o)=>e.jsx(rt,{book:m,index:o},m.id))}),n&&r.length>0&&e.jsxs(d.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},className:"mt-8 text-center text-neutral-600",children:["Found ",r.length," ",r.length===1?"book":"books",' matching "',n,'"']})]})})})},dt="Left",ut="Right",mt="Up",ht="Down",M={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},ee={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},de="mousemove",ue="mouseup",xt="touchend",ft="touchmove",pt="touchstart";function gt(t,s,r,i){return t>s?r>0?ut:dt:i>0?ht:mt}function me(t,s){if(s===0)return t;const r=Math.PI/180*s,i=t[0]*Math.cos(r)+t[1]*Math.sin(r),n=t[1]*Math.cos(r)-t[0]*Math.sin(r);return[i,n]}function bt(t,s){const r=o=>{const c="touches"in o;c&&o.touches.length>1||t((h,f)=>{f.trackMouse&&!c&&(document.addEventListener(de,i),document.addEventListener(ue,b));const{clientX:g,clientY:w}=c?o.touches[0]:o,N=me([g,w],f.rotationAngle);return f.onTouchStartOrOnMouseDown&&f.onTouchStartOrOnMouseDown({event:o}),Object.assign(Object.assign(Object.assign({},h),ee),{initial:N.slice(),xy:N,start:o.timeStamp||0})})},i=o=>{t((c,h)=>{const f="touches"in o;if(f&&o.touches.length>1)return c;if(o.timeStamp-c.start>h.swipeDuration)return c.swiping?Object.assign(Object.assign({},c),{swiping:!1}):c;const{clientX:g,clientY:w}=f?o.touches[0]:o,[N,S]=me([g,w],h.rotationAngle),y=N-c.xy[0],k=S-c.xy[1],O=Math.abs(y),v=Math.abs(k),C=(o.timeStamp||0)-c.start,A=Math.sqrt(O*O+v*v)/(C||1),B=[y/(C||1),k/(C||1)],_=gt(O,v,y,k),L=typeof h.delta=="number"?h.delta:h.delta[_.toLowerCase()]||M.delta;if(O<L&&v<L&&!c.swiping)return c;const P={absX:O,absY:v,deltaX:y,deltaY:k,dir:_,event:o,first:c.first,initial:c.initial,velocity:A,vxvy:B};P.first&&h.onSwipeStart&&h.onSwipeStart(P),h.onSwiping&&h.onSwiping(P);let F=!1;return(h.onSwiping||h.onSwiped||h[`onSwiped${_}`])&&(F=!0),F&&h.preventScrollOnSwipe&&h.trackTouch&&o.cancelable&&o.preventDefault(),Object.assign(Object.assign({},c),{first:!1,eventData:P,swiping:!0})})},n=o=>{t((c,h)=>{let f;if(c.swiping&&c.eventData){if(o.timeStamp-c.start<h.swipeDuration){f=Object.assign(Object.assign({},c.eventData),{event:o}),h.onSwiped&&h.onSwiped(f);const g=h[`onSwiped${f.dir}`];g&&g(f)}}else h.onTap&&h.onTap({event:o});return h.onTouchEndOrOnMouseUp&&h.onTouchEndOrOnMouseUp({event:o}),Object.assign(Object.assign(Object.assign({},c),ee),{eventData:f})})},a=()=>{document.removeEventListener(de,i),document.removeEventListener(ue,b)},b=o=>{a(),n(o)},x=(o,c)=>{let h=()=>{};if(o&&o.addEventListener){const f=Object.assign(Object.assign({},M.touchEventOptions),c.touchEventOptions),g=[[pt,r,f],[ft,i,Object.assign(Object.assign({},f),c.preventScrollOnSwipe?{passive:!1}:{})],[xt,n,f]];g.forEach(([w,N,S])=>o.addEventListener(w,N,S)),h=()=>g.forEach(([w,N])=>o.removeEventListener(w,N))}return h},m={ref:o=>{o!==null&&t((c,h)=>{if(c.el===o)return c;const f={};return c.el&&c.el!==o&&c.cleanUpTouch&&(c.cleanUpTouch(),f.cleanUpTouch=void 0),h.trackTouch&&o&&(f.cleanUpTouch=x(o,h)),Object.assign(Object.assign(Object.assign({},c),{el:o}),f)})}};return s.trackMouse&&(m.onMouseDown=r),[m,x]}function yt(t,s,r,i){return!s.trackTouch||!t.el?(t.cleanUpTouch&&t.cleanUpTouch(),Object.assign(Object.assign({},t),{cleanUpTouch:void 0})):t.cleanUpTouch?s.preventScrollOnSwipe!==r.preventScrollOnSwipe||s.touchEventOptions.passive!==r.touchEventOptions.passive?(t.cleanUpTouch(),Object.assign(Object.assign({},t),{cleanUpTouch:i(t.el,s)})):t:Object.assign(Object.assign({},t),{cleanUpTouch:i(t.el,s)})}function wt(t){const{trackMouse:s}=t,r=l.useRef(Object.assign({},ee)),i=l.useRef(Object.assign({},M)),n=l.useRef(Object.assign({},i.current));n.current=Object.assign({},i.current),i.current=Object.assign(Object.assign({},M),t);let a;for(a in M)i.current[a]===void 0&&(i.current[a]=M[a]);const[b,x]=l.useMemo(()=>bt(j=>r.current=j(r.current,i.current),{trackMouse:s}),[s]);return r.current=yt(r.current,i.current,n.current,x),b}const jt=()=>{const{bookId:t}=Ce(),s=Ie(),{books:r,settings:i,setSettings:n}=te(),[a,b]=l.useState(null),[x,j]=l.useState(0),[m,o]=l.useState(!1),[c]=l.useState(3e3),[h,f]=l.useState(!0),[g,w]=l.useState(!1),[N,S]=l.useState(0),[y,k]=l.useState(null),[O,v]=l.useState(null),[C,A]=l.useState(null),[B,_]=l.useState(new Set),L=l.useRef(null),P=l.useRef(null),F=i.enableSounds,R=window.matchMedia("(prefers-reduced-motion: reduce)").matches?200:650,se=[.77,0,.175,1],ae=[.33,1,.68,1],J=l.useCallback(u=>B.has(u)?Promise.resolve():new Promise((p,H)=>{const E=new Image;E.onload=()=>{_(T=>{const I=new Set(T);return I.add(u),I}),p()},E.onerror=()=>{console.error(`Failed to preload image: ${u}`),p()},E.src=u}),[B]),$=l.useCallback(async(u,p=2,H=1)=>{if(!a||a.pages.length<=1)return;const E=a.pages.length;for(let T=1;T<=p;T++){const I=(u+T)%E,D=a.pages[I];D.media&&D.media.length>0&&J(D.media[0].url)}for(let T=1;T<=H;T++){const I=(u-T+E)%E,D=a.pages[I];D.media&&D.media.length>0&&J(D.media[0].url)}},[a,J]);l.useEffect(()=>{if(t&&r.length>0){const u=r.find(p=>p.id===t);if(u){if(b(u),u.pages.length>0){const p=u.pages[0];p.media&&p.media.length>0&&J(p.media[0].url),$(0)}}else s("/404")}},[t,r,s,J,$]),l.useEffect(()=>{a&&$(x)},[x,a,$]);const ne=()=>{try{const u=new Audio("data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmMdAJJAf2j9+8pUGwo6nNvhpF0OBEWr2+XMeUcNI3fU8OOlZ0MRLNzv1JJAIxE5nuvgmV8PBDuj6vKoeFEWY4DV8t2MUBoBH4jV8OfNuFYUC5XP3Z5+SQkVKYDa3Z9QGgEfnvXdpEsOFI7V8d2QPwUQdcvz4pZJGgozlNfhpVEOBkir2+PNekkLK3rS69qXWBAOJpnO3qJQEgc7n97gqF0PBEij2+XNeUoOJ3rJ8NqVXBELJJvV3qdUEQcshOXuwmgiDTiR2OzLgGYZBzOJ1+e8Z0AJXrfn5b9RLwYqh8vmwGFGBSeh4veualEJNZzV5Z5wSgQcjdrjxGU5CTWZze2vZzIEHYTa5L9SNgcpidflvmlOBCCY1+mxY0MJNZ7P6ateLgUug9jnwmlRBSKR2+zLfGASEm/F8d2QQREUJqfh9baLSTQHOZPW4qFbGAoqhtvmunBUDBKX2+bDYUEHLIHa5bhiOAcx");u.volume=.1,u.play().catch(()=>{})}catch{}},Q=l.useCallback(()=>{if(!a||g)return;const u=(x+1)%a.pages.length;u===0&&m&&o(!1),w(!0),k("next"),A(u),F&&ne(),setTimeout(()=>{j(u),setTimeout(()=>{w(!1),k(null),A(null)},20)},R)},[a,g,x,m,F,R]);l.useEffect(()=>{if(m&&a&&a.pages.length>1){G(),S(0);const u=100/(c/50);P.current=setInterval(()=>{S(p=>p>=100?0:p+u)},50),L.current=setTimeout(()=>{Q()},c)}else G();return()=>G()},[m,x,c,a,Q]);const G=()=>{L.current&&(clearTimeout(L.current),L.current=null),P.current&&(clearInterval(P.current),P.current=null),S(0)},re=()=>{if(!a||g)return;const u=x===0?a.pages.length-1:x-1;w(!0),k("prev"),v(u),F&&ne(),setTimeout(()=>{j(u),setTimeout(()=>{w(!1),k(null),v(null)},20)},R)},Ne=wt({onSwipedLeft:()=>!g&&Q(),onSwipedRight:()=>!g&&re(),preventScrollOnSwipe:!0,trackMouse:!0,trackTouch:!0,delta:10}),Se=()=>{o(!m),m&&G()},ke=()=>{f(!h),setTimeout(()=>f(!0),3e3)},V=(u,p=!0)=>{var H,E;return e.jsxs(e.Fragment,{children:[u.media&&u.media.length>0&&e.jsx("div",{className:"absolute inset-1 flex items-center justify-center pt-16 pb-16",children:e.jsx(d.img,{src:u.media[0].url,alt:u.media[0].altText||u.title,style:{height:"fit-content",maxHeight:"100vh",borderRadius:"12px",inset:"0.25rem"},className:"w-full h-full object-contain",initial:p?{scale:1.1,opacity:0}:{},animate:p?{scale:1,opacity:1}:{},transition:{duration:.8}})}),e.jsx(d.div,{initial:p?{y:20,opacity:0}:{},animate:p?{y:0,opacity:1}:{},transition:{delay:.3},className:"absolute bottom-20 left-4 right-4 z-30",children:e.jsxs("div",{className:"",children:[e.jsx("h2",{className:"text-lg font-bold text-white drop-shadow-lg",children:u.title}),e.jsx("p",{className:"text-xs text-white/80 mt-1 drop-shadow-sm",children:new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})})]})}),u.content&&e.jsx(d.div,{initial:p?{x:20,opacity:0}:{},animate:p?{x:0,opacity:1}:{},transition:{delay:.4},className:"absolute top-1/2 right-4 transform -translate-y-1/2 z-30 max-w-xs",children:e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-lg px-3 py-2 border border-white/20 shadow-2xl",children:e.jsx("div",{className:"text-white text-xs leading-relaxed drop-shadow-sm",children:u.content})})}),u.media&&((H=u.media[0])==null?void 0:H.caption)&&e.jsx(d.div,{initial:p?{y:-20,opacity:0}:{},animate:p?{y:0,opacity:1}:{},transition:{delay:.5},className:"absolute top-20 left-4 z-30",children:e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-lg px-3 py-2 border border-white/20 shadow-2xl",children:e.jsx("p",{className:"text-white/90 text-xs italic drop-shadow-sm",children:(E=u.media[0])==null?void 0:E.caption})})}),u.tags.length>0&&e.jsx(d.div,{initial:p?{y:-20,opacity:0}:{},animate:p?{y:0,opacity:1}:{},transition:{delay:.6},className:"absolute top-20 right-4 z-30",children:e.jsx("div",{className:"bg-white/10 backdrop-blur-md rounded-lg px-3 py-2 border border-white/20 shadow-2xl",children:e.jsx("div",{className:"flex flex-wrap gap-1",children:u.tags.map((T,I)=>e.jsxs("span",{className:"px-2 py-0.5 bg-white/20 text-white rounded-full text-xs font-medium border border-white/30",children:["#",T]},I))})})})]})};if(!a)return e.jsx(d.div,{initial:{opacity:0},animate:{opacity:1},className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),e.jsx("p",{className:"text-neutral-600",children:"Loading book..."})]})});const z=a.pages[x];return e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"min-h-screen relative overflow-hidden",onClick:ke,children:[e.jsx("div",{className:"fixed inset-0 z-0",children:z.media&&z.media.length>0?e.jsxs(e.Fragment,{children:[e.jsx(d.img,{src:z.media[0].url,alt:"",className:"w-full h-full object-cover",style:{filter:"blur(12px)",transform:"scale(1.2)"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.8}}),e.jsx("div",{className:"absolute inset-0 bg-black/30"})]}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-primary-50 via-secondary-50 to-neutral-100"})}),e.jsx(W,{mode:"wait",children:h&&e.jsx(d.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},transition:{duration:.3},className:"absolute top-0 left-0 right-0 z-30 bg-gradient-to-b from-black/20 to-transparent",children:e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>s("/books"),className:"flex items-center gap-1 px-2 py-1 bg-white/20 backdrop-blur-md rounded-full shadow-lg hover:bg-white/30 transition-colors border border-white/20",children:[e.jsx(ye,{className:"w-3 h-3"}),e.jsx("span",{className:"text-xs font-medium text-white",children:"Back"})]}),e.jsxs("div",{className:"text-center text-white",children:[e.jsx("h1",{className:"text-sm font-bold drop-shadow-lg",children:a.title}),e.jsxs("p",{className:"text-xs opacity-80",children:[x+1,"/",a.pages.length]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>n({...i,enableSounds:!i.enableSounds}),className:"p-1.5 bg-white/20 backdrop-blur-md rounded-full shadow-lg hover:bg-white/30 transition-colors border border-white/20",children:i.enableSounds?e.jsx(_e,{className:"w-3 h-3 text-white"}):e.jsx(Je,{className:"w-3 h-3 text-white"})}),e.jsxs(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Se,className:"flex items-center gap-1 px-2 py-1 bg-white/20 backdrop-blur-md rounded-full shadow-lg hover:bg-white/30 transition-colors border border-white/20",children:[m?e.jsx(ze,{className:"w-3 h-3 text-white"}):e.jsx(He,{className:"w-3 h-3 text-white"}),e.jsx("span",{className:"text-xs font-medium text-white",children:m?"Pause":"Auto"})]})]})]})})}),m&&e.jsx(d.div,{className:"absolute top-16 left-4 right-4 z-30 bg-white/20 backdrop-blur-md rounded-full h-1 overflow-hidden border border-white/20",initial:{opacity:0},animate:{opacity:1},children:e.jsx(d.div,{className:"h-full bg-white",style:{width:`${N}%`},transition:{duration:.1}})}),e.jsx("div",{...Ne,className:"relative h-screen flex items-center justify-center z-10",children:e.jsxs(d.div,{className:"relative w-full h-full z-20",children:[e.jsx("div",{className:"absolute inset-0 w-full h-full overflow-hidden",style:{zIndex:4},children:y==="next"&&C!==null?V(a.pages[C],!1):V(z,y===null)}),y==="next"&&e.jsx(d.div,{className:"absolute inset-0 w-full h-full overflow-hidden",style:{transformOrigin:"left center",zIndex:10},initial:{scaleX:1,x:0},animate:{scaleX:.05,x:"-10%"},transition:{scaleX:{duration:R/1e3,ease:se},x:{duration:R/1e3,ease:ae}},children:e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[V(z,!1),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 w-1/5 bg-gradient-to-r from-black/25 to-transparent"})]})},"next-shrink"),y==="prev"&&O!==null&&e.jsx(d.div,{className:"absolute inset-0 w-full h-full overflow-hidden",style:{transformOrigin:"left center",zIndex:10},initial:{scaleX:.05,x:"-10%"},animate:{scaleX:1,x:0},transition:{scaleX:{duration:R/1e3,ease:se},x:{duration:R/1e3,ease:ae}},children:e.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[V(a.pages[O],!1),e.jsx("div",{className:"pointer-events-none absolute inset-y-0 left-0 w-1/5 bg-gradient-to-r from-black/25 to-transparent"})]})},"prev-expand")]})}),e.jsx(W,{children:h&&e.jsx(d.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},transition:{duration:.3},className:"absolute bottom-0 left-0 right-0 z-30 bg-gradient-to-t from-black/20 to-transparent",children:e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:re,disabled:g,className:"flex items-center gap-1 px-2 py-1 bg-white/20 backdrop-blur-md rounded-full shadow-lg hover:bg-white/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed border border-white/20",children:[e.jsx(Xe,{className:"w-3 h-3 text-white"}),e.jsx("span",{className:"text-xs font-medium text-white",children:"Previous"})]}),e.jsx("div",{className:"flex items-center gap-1",children:a.pages.map((u,p)=>e.jsx(d.button,{whileHover:{scale:1.2},whileTap:{scale:.8},onClick:()=>!g&&j(p),className:`w-2 h-2 rounded-full transition-colors ${p===x?"bg-white border border-white/50":"bg-white/30 hover:bg-white/50 border border-white/20"}`},p))}),e.jsxs(d.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:Q,disabled:g,className:"flex items-center gap-1 px-2 py-1 bg-white/20 backdrop-blur-md rounded-full shadow-lg hover:bg-white/30 transition-colors disabled:opacity-50 disabled:cursor-not-allowed border border-white/20",children:[e.jsx("span",{className:"text-xs font-medium text-white",children:"Next"}),e.jsx(ge,{className:"w-3 h-3 text-white"})]})]})})})]})},he=()=>e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"min-h-screen p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-800 mb-8",children:"Edit Book"}),e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-neutral-600",children:"Book editing functionality will be implemented next."})})]})}),vt=()=>e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"min-h-screen p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-neutral-800 mb-8",children:"Settings"}),e.jsx("div",{className:"text-center py-16",children:e.jsx("p",{className:"text-neutral-600",children:"Settings functionality will be implemented next."})})]})}),Nt=()=>e.jsx(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"min-h-screen flex items-center justify-center p-6",children:e.jsxs("div",{className:"text-center max-w-md",children:[e.jsxs(d.div,{initial:{scale:.8},animate:{scale:1},transition:{delay:.2,duration:.5},className:"mb-8",children:[e.jsx("div",{className:"text-8xl font-bold text-primary-500 mb-4",children:"404"}),e.jsx("h1",{className:"text-2xl font-bold text-neutral-800 mb-2",children:"Page Not Found"}),e.jsx("p",{className:"text-neutral-600",children:"The page you're looking for doesn't exist or has been moved."})]}),e.jsxs(d.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},className:"space-y-4",children:[e.jsxs(X,{to:"/",className:"inline-flex items-center px-6 py-3 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors font-semibold",children:[e.jsx(be,{className:"w-5 h-5 mr-2"}),"Go Home"]}),e.jsx("div",{children:e.jsxs("button",{onClick:()=>window.history.back(),className:"inline-flex items-center px-6 py-3 bg-neutral-200 text-neutral-800 rounded-lg hover:bg-neutral-300 transition-colors font-semibold",children:[e.jsx(ye,{className:"w-5 h-5 mr-2"}),"Go Back"]})})]})]})});function St(){const[t,s]=l.useState([]),[r,i]=l.useState(null),[n,a]=l.useState(null),[b,x]=l.useState(le),[j,m]=l.useState(!0),[o,c]=l.useState(null);l.useEffect(()=>{(async()=>{try{m(!0);const g=localStorage.getItem("baby-book-settings");if(g){const w=JSON.parse(g);x({...le,...w})}try{const w=await fetch("/baby-book/books-manifest.json");if(w.ok){const S=(await w.json()).books.map(y=>{var k,O;return{id:y.id,title:y.title,description:y.description||"",coverImage:y.coverImage?{id:`cover-${y.id}`,type:"image",url:`/baby-book/${y.coverImage.src}`,thumbnailUrl:(O=(k=y.coverImage.srcSet)==null?void 0:k.webp)==null?void 0:O.split(" ")[0],altText:y.coverImage.alt||y.title,metadata:{width:y.coverImage.width,height:y.coverImage.height},uploadedAt:new Date}:void 0,pages:y.pages.map((v,C)=>{var A,B;return{id:v.id,bookId:y.id,title:v.title,content:v.description||"",media:v.image?[{id:`media-${v.id}`,type:"image",url:`/baby-book/${v.image.src}`,thumbnailUrl:(B=(A=v.image.srcSet)==null?void 0:A.webp)==null?void 0:B.split(" ")[0],altText:v.image.alt||v.title,metadata:{width:v.image.width,height:v.image.height},uploadedAt:new Date}]:[],dateCreated:new Date,dateModified:new Date,pageNumber:v.pageNumber||C+1,layout:"single-photo",tags:[]}}),dateCreated:new Date,dateModified:new Date,isPublic:!1,totalPages:y.pages.length,theme:{primaryColor:"#3B82F6",secondaryColor:"#F59E0B",fontFamily:"Inter",pageStyle:"modern"},metadata:{babyName:y.title,tags:[]}}});s(S)}else{const N=localStorage.getItem("baby-book-books");if(N){const S=JSON.parse(N);s(S)}}}catch(w){console.error("Failed to load books:",w);const N=localStorage.getItem("baby-book-books");if(N){const S=JSON.parse(N);s(S)}}await new Promise(w=>setTimeout(w,800))}catch(g){c("Failed to load application data"),console.error("Failed to load initial data:",g)}finally{m(!1)}})()},[]),l.useEffect(()=>{if(t.length>0){const f=localStorage.getItem("baby-book-last-book");if(f){const g=t.find(w=>w.id===f);g&&i(g)}}},[t]);const h={books:t,setBooks:s,currentBook:r,setCurrentBook:i,user:n,setUser:a,settings:b,setSettings:x,isLoading:j,setIsLoading:m,error:o,setError:c};return j?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-secondary-50 flex items-center justify-center",children:e.jsxs(d.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.5},className:"text-center",children:[e.jsx(d.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-primary-200 border-t-primary-500 rounded-full mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-neutral-800 mb-2",children:"Loading Baby Book"}),e.jsx("p",{className:"text-neutral-600",children:"Preparing your precious memories..."})]})}):o?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50 flex items-center justify-center",children:e.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center p-8 max-w-md",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-red-500 text-2xl",children:"⚠️"})}),e.jsx("h2",{className:"text-xl font-semibold text-neutral-800 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-neutral-600 mb-6",children:o}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-6 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 transition-colors",children:"Reload App"})]})}):e.jsx(Ke,{value:h,children:e.jsx(tt,{children:e.jsx(at,{children:e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 via-white to-secondary-50",children:e.jsx(nt,{children:e.jsx(W,{mode:"wait",children:e.jsxs(Ae,{children:[e.jsx(U,{path:"/",element:e.jsx(ct,{})}),e.jsx(U,{path:"/book/:bookId",element:e.jsx(jt,{})}),e.jsx(U,{path:"/book/:bookId/edit",element:e.jsx(he,{})}),e.jsx(U,{path:"/dev/book-creator",element:e.jsx(he,{})}),e.jsx(U,{path:"/settings",element:e.jsx(vt,{})}),e.jsx(U,{path:"/404",element:e.jsx(Nt,{})}),e.jsx(U,{path:"*",element:e.jsx(Be,{to:"/404",replace:!0})})]})})})})})})})}const kt=new $e({defaultOptions:{queries:{staleTime:5*60*1e3,refetchOnWindowFocus:!1,retry:3},mutations:{retry:1}}});K.createRoot(document.getElementById("root")).render(e.jsx(xe.StrictMode,{children:e.jsx(Le,{basename:"/baby-book",children:e.jsx(Qe,{client:kt,children:e.jsx(St,{})})})}));
